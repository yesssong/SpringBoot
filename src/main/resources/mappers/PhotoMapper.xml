<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.githrd.demo_photo.dao.PhotoMapper">

   <!-- 전체조회 -> selectList -->
   <select id="selecList"  resultType="photo">
     	select * from photo order by p_idx desc
   </select>
   
   <!-- Paging별 조회 			변수 2개 이상일 때 Map으로 넘겨주기	 -->
   <select id="selectPageList" parameterType="Map" resultType="photo">
    select pp.* from
	 (
      select
         rank() over(order by p_idx desc) as no,
         p.*
      from
         (select * from photo) p
	 ) pp                            
	 where no between #{start} and #{end}
	 				<!-- Map의 키 값 -->
   </select>
   
   <!-- 전체 레코드 수 구하기(전체 게시물 수) -->
   <select id="selectRowTotal" resultType="int">
   		select ifnull(count(*),0) from photo
   		<!-- nvl = null value -> 값이 없을 경우 (Oracle함수) 
              ifnull (MySQL 함수)로 수정 -->
   </select>
   
   <select id="selectOne" parameterType="int" resultType="photo">
   		select * from photo where p_idx=#{p_idx}
   </select>
   
   <!-- 추가 -->
   <insert id="insert" parameterType="photo">
   		insert into photo values(null,
                                  #{p_title},#{p_content},#{p_filename},#{p_ip},
                                  now(),
                                  #{mem_idx},#{mem_name})
   </insert>
   
   <!-- 삭제 -->
   <delete id="delete" parameterType="int">
   		delete from photo where p_idx=#{p_idx}
   </delete>
   
   <!-- 수정 - 파일 이름 -->
   <update id="updateFilename" parameterType="photo">
   		update photo set p_filename=#{p_filename} where p_idx=#{p_idx}
   </update>
   
   <!-- 수정 - 이미지 파일 -->
   <update id="update" parameterType="photo">
  		 update photo set p_title=#{p_title},p_content=#{p_content},p_ip=#{p_ip},p_regdate=sysdate where p_idx=#{p_idx}
   </update>

   
</mapper>












